# Вариант 39 — «Список дел» — R1 Cards (карточки и пользовательские истории)

## 1 Формы и валидации (обязательные поля)

### Форма входа

- `email`: string, email, required → «Введите корректный email.»
- `password`: string, min 6, required → «Пароль должен содержать минимум 6 символов.»

### Форма регистрации

- `username`: string, 3–50, `[a-zA-Z0-9_]` → «Имя пользователя должно быть 3–50 символов (буквы/цифры).»
- `email`: string, email, unique → «Email уже используется.»
- `password`: string, min 6 → «Пароль должен содержать минимум 6 символов.»
- `confirmPassword`: equals password → «Пароли не совпадают.»

### Task

- `title`: string, 1–200 → «Введите название задачи.»
- `description`: string, optional, max 5000
- `due_at`: datetime, optional → «Неверный формат даты.»
- `repeat_interval_minutes`: int, optional, `>= 1` → «Интервал повтора должен быть положительным числом.»
- `subtasks`: array, optional
- `tags`: array of strings, optional

### SubTask

- `title`: string, 1–200 → «Введите название подзадачи.»
- `is_done`: boolean

### Tag

- `name`: string, 1–32, unique per user → «Тег уже существует.»
- `color`: string, optional, hex `#RRGGBB` → «Неверный формат цвета.»

### File

- `file`: multipart, max 10 MB → «Размер файла не должен превышать 10 МБ.»
- `mime_type`: allowlist → «Недопустимый тип файла.»
- `filename`: safe name → «Некорректное имя файла.»

### Reminder

- `remind_at`: datetime, required → «Укажите дату и время напоминания.»
- `message`: string, 1–200 → «Введите текст напоминания.»

---

## 2 User Stories (10) + критерии приёмки (AC)

### US-01 — Регистрация

**Как** Guest  
**Я хочу** зарегистрироваться  
**Чтобы** создавать задачи.

**AC:**
- Email уникален.
- Пароль сохраняется в виде хеша.
- Пользователь получает роль `user`.
- После успеха показано сообщение и доступен вход.

### US-02 — Вход

**Как** User  
**Я хочу** войти  
**Чтобы** видеть свой список задач.

**AC:**
- При успешном входе выдаётся JWT.
- При ошибке показано понятное сообщение.
- После входа редирект на `/tasks`.

### US-03 — Создание задачи

**Как** User  
**Я хочу** создать задачу  
**Чтобы** зафиксировать дело.

**AC:**
- `title` обязателен.
- После сохранения задача появляется в списке.
- Сервер валидирует поля и возвращает ошибки в читаемом виде.

### US-04 — Создание задачи с подзадачами

**Как** User  
**Я хочу** добавить подзадачи сразу  
**Чтобы** не редактировать потом.

**AC:**
- Подзадачи создаются вместе с задачей.
- Список подзадач отображается корректно (без “съезда” элементов).
- Можно отметить подзадачу выполненной.

### US-05 — Создание тегов при создании задачи

**Как** User  
**Я хочу** вводить новые теги прямо в форме создания  
**Чтобы** не идти в отдельный раздел.

**AC:**
- Если тег не существует, сервер создаёт его автоматически.
- Теги привязываются к задаче.
- Повторный ввод существующего тега не создаёт дубликаты.

### US-06 — Фильтрация и поиск задач

**Как** User  
**Я хочу** искать и фильтровать задачи  
**Чтобы** быстрее находить нужные.

**AC:**
- Поддерживаются `q`, `is_done`, `tag`, диапазон дедлайна.
- Пагинация `limit/offset` работает и не ломает выдачу.

### US-07 — Календарь дедлайнов

**Как** User  
**Я хочу** видеть дедлайны на календаре  
**Чтобы** планировать дни.

**AC:**
- Отображаются только задачи с `due_at`.
- Клик по задаче ведёт в `/tasks/:id`.

### US-08 — Файлы к задаче

**Как** User  
**Я хочу** прикрепить файл  
**Чтобы** хранить материалы рядом с задачей.

**AC:**
- Upload/list/download/delete доступны.
- Лимиты по размеру/типу соблюдаются.
- Доступ к файлам ограничен владельцем (или admin).

### US-09 — Напоминания

**Как** User  
**Я хочу** создавать напоминания  
**Чтобы** не забывать о дедлайнах.

**AC:**
- `remind_at` обязателен.
- Напоминание видно в списке и удаляется.
- Доступ ограничен владельцем (или admin).

### US-10 — Повторяющиеся задачи (приёмка MVP)

**Как** User  
**Я хочу** генерировать следующий повтор  
**Чтобы** автоматизировать рутину.

**AC:**
- `generate-next` создаёт новую задачу на основе repeat-интервала.
- Унаследованы `title/description/tags`.
- Доступ ограничен владельцем (или admin).
